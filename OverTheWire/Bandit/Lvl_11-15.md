# OverTheWire: Bandit

### LvL 11-15

---

**Lvl 11**

"The password for the next level is stored in the file **data.txt**, which contains base64 encoded data"

To decode a base64 encoded file, we can use online tool like Cyberchef, or decode directly into the terminal with the `base64` command and the `-d` flag who stand for decode.

```bash
bandit10@bandit:~$ ls
data.txt
bandit10@bandit:~$ base64 -d data.txt 
The password is password_is_here
```

---

**Lvl 12**

"The password for the next level is stored in the file **data.txt**,
where all lowercase (a-z) and uppercase (A-Z) letters have been
rotated by 13 positions"

It's a basic in cryptography, the ROT13 encryption, for this one the easiest way is to use an online ROT13 decryption tool, like Cyberchef.

```bash
bandit11@bandit:~$ ls
data.txt
bandit11@bandit:~$ cat data.txt 
Gur cnffjbeq vf 7k16JArUVv5LxVuJfsSVdbbtaHGlw9D4
```

When paste it in Cyberchef and add ROT13 operations, we obtain the password.

```bash
The password is password_is_here
```

---

**Lvl 13**

"The password for the next level is stored in the file **data.txt**,
which is a hexdump of a file that has been repeatedly compressed.
For this level it may be useful to create a directory under /tmp in
which you can work. Use mkdir with a hard to guess directory name.
Or better, use the command “mktemp -d”."


First let's create a temporary directory with `mktemp -d` command.

```bash
bandit12@bandit:~$ mktemp -d
/tmp/tmp.ae5KSlUPtd
bandit12@bandit:~$ cd /tmp/tmp.ae5KSlUPtd
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ 
```

Then copy our **data.txt** file in this directory

```bash
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ cp /home/bandit12/data.txt .
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ ls
data.txt
```

Now, we have to check the type of file it is, then decompress it in the right way.

The file is a hexdump but we need the data, so we have to revert the hexdump and retrieve the data.

```bash
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ xxd -r data.txt data1
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ ls
data1  data.txt
```

Now, we have to repeat the following steps until we get an ASCII file.

- First check the type of file we have file `file` command, in this challenge, we can have `gzip`, `bzip2` or`tar` files.
  
  - **gzip**: rename the file to end with `.gz`, then decompress it with `gzip -d file.gz`.
  
  - **bzip2**: rename the file to end with `bz2`, then decompress it with `bzip2 -d file.bz2`.
  
  - **tar**: rename the file to end with `.tar`, then decompress it with `tar -xf file.tar`.

```bash
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ file data1
data1: gzip compressed data

bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ mv data1 data.gz

bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ gzip -d data.gz 

bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ ls
data
```

And repeat this step until we get an ASCII file:

```bash
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ file data 
data: bzip2 compressed data, block size = 900k
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ mv data data.bz2
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ bzip2 -d data.bz2 
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ ls
data
```

```bash
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ file data 
data: gzip compressed data
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ mv data data.gz
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ gzip -d data.gz 
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ ls
data
```

```bash
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ file data 
data: POSIX tar archive (GNU)
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ mv data data.tar
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ tar -xf data.tar 
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ ls
data5.bin  data.tar
```

```bash
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ file data5.bin 
data5.bin: POSIX tar archive (GNU)
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ mv data5.bin data5.tar
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ tar -xf data5.tar 
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ ls
data5.tar  data6.bin  data.tar
```

```bash
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ file data6.bin 
data6.bin: bzip2 compressed data, block size = 900k
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ rm data.tar data5.tar 
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ mv data6.bin data.bz2
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ bzip2 -d data.bz2 
```

```bash
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ file data 
data: POSIX tar archive (GNU)
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ mv data data.tar
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ tar -xf data.tar 
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ ls
data8.bin  data.tar
```

```bash
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ file data8.bin 
data8.bin: gzip compressed data
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ rm data.tar 
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ mv data8.bin data.gz
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ gzip -d data.gz 
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ ls
data
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ file data 
data: ASCII text
```

Here, we have an ASCII file, we just have to print the file to get the password.

```bash
bandit12@bandit:/tmp/tmp.ae5KSlUPtd$ cat data 
The password is password_is_here
```

---

**Lvl 14**

"The password for the next level is stored in **/etc/bandit_pass/bandit14 and can only be read by user
bandit14**. For this level, you don’t get the next password, but you
get a private SSH key that can be used to log into the next level.
Look at the commands that logged you into previous bandit levels,
and find out how to use the key for this level."

When log as the user bandit13, we have our sshkey file when listing file:

```bash
bandit13@bandit:~$ ls
sshkey.private
```

We have to copy this key to our own computer. Now log to the bandit14 level using the sshkey with the `-i` flag.

```bash
simsdu@computer:~$ ssh -i sshkey.private bandit14@bandit.labs.overthewire.org -p 2220
Permissions 0640 for 'sshkey.private' are too open.
```

We get an error message because our sshkey have too much permission, let's change it with the `chmod` command

```bash
simsdu@computer:~$ chmod 700 sshkey.private 
```

Then try again to connect

```bash
simsdu@computer:~$ ssh -i sshkey.private bandit14@bandit.labs.overthewire.org-p 2220
                   _                     _ _ _   
                  | |__   __ _ _ __   __| (_) |_ 
                  | '_ \ / _` | '_ \ / _` | | __|
                  | |_) | (_| | | | | (_| | | |_ 
                  |_.__/ \__,_|_| |_|\__,_|_|\__|


```

We are now connected to the level 14.

---

**Lvl 15**

"The password for the next level can be retrieved by submitting the
password of the current level to **port 30000 on localhost**."

The password is stored in **/etc/bandit_pass/bandit14**, 

```bash
bandit14@bandit:~$ cat /etc/bandit_pass/bandit14
MU4VWeTyJk8ROof1qqmcBPaLh7lDCPvS
```

Now, we have to submit this password to port 30000 on localhost with netcat :`nc`.

```bash
bandit14@bandit:~$ nc localhost 30000
MU4VWeTyJk8ROof1qqmcBPaLh7lDCPvS
Correct!
password_is_here
```


